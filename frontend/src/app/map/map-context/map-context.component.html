<div class="legends" *ngIf="legendVisible" [ngClass]="currentTab == 0 ? 'tab-inactive menu-inactive' : 'tab menu-active'">
  <div>
    <button
      class="tablinks"
      (click)="currentLegend = 'Legenda'"
      [ngClass]="currentLegend == 'Legenda' ? 'active' : 'inactive'"
      style="position: relative; width: 50%"
    >
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="25"
        height="25"
        viewBox="0 0 32 32"
      >
        <path
          d="M22 2H2v20h20zM3 21V3h13.287a2.523 2.523 0 0 0-1.241 1.852 1.71 1.71 0 0 0 .204.801 1.92 1.92 0 0 0-.618.846 1.47 1.47 0 0 0-.081.501q0 .066.007.14a1.93 1.93 0 0 0-.764.573 1.416 1.416 0 0 0-.35 1.17 2.006 2.006 0 0 1 .072.76 2.51 2.51 0 0 0-.997 1.069 1.699 1.699 0 0 0-.97-.316 1.6 1.6 0 0 0-1.563 1.631.515.515 0 0 1-.06.172 1.77 1.77 0 0 0-1.553-1.008 1.797 1.797 0 0 0-1.759 1.829 2.473 2.473 0 0 0 .098.664.735.735 0 0 1 .034.162c-.005.002-.046.078-.076.133a2.17 2.17 0 0 0-.32 1.09 1.508 1.508 0 0 0 1.455 1.458 1.731 1.731 0 0 0 1.128 2.908l.02.004-.05.141A2.882 2.882 0 0 0 8.767 21zm18 0h-7.04c.008-.09.013-1.178.013-1.26 0-.03-.002-.062-.005-.097a2.144 2.144 0 0 0-.045-.337l.047-.023a1.794 1.794 0 0 0 1.224-1.594 1.345 1.345 0 0 0-.081-.461 1.71 1.71 0 0 0 .606-1.13 1.555 1.555 0 0 0 .195.013 1.58 1.58 0 0 0 1.185-.54 1.691 1.691 0 0 0 .243.26 2.491 2.491 0 0 0 1.821.577 4.318 4.318 0 0 0 1.837-.57zm0-6.13c-.407.11-.894.538-1.028.538h-.809a1.656 1.656 0 0 1-1.166-.332c-.34-.295-.331-.892-.794-.892-.621 0-.668.927-1.289.927-.281 0-.413-.2-.694-.2a.456.456 0 0 0-.495.405v.645c0 .545-.73.654-.73 1.2 0 .222.2.306.2.529 0 .744-1.325.644-1.325 1.388 0 .244.09.39.1.625a.145.145 0 0 1 .003.037A5.369 5.369 0 0 1 12.75 21H9.68a4.04 4.04 0 0 1-.015-.246 2.749 2.749 0 0 1 .226-.967 2.12 2.12 0 0 0 .137-.717c0-.703-1.342-.504-1.552-.926-.525-1.046.89-1.316.89-2.15 0-.205-.105-.627-.43-.662-.452-.045-.569.2-1.023.2a.52.52 0 0 1-.562-.464c0-.496.395-.726.395-1.222 0-.325-.132-.506-.132-.827a.795.795 0 0 1 .759-.828c.416 0 .595.34.794.694a.828.828 0 0 0 .794.398c.63 0 1.025-.785 1.025-1.256a.608.608 0 0 1 .563-.63c.445 0 .612.462 1.057.462.736 0 .71-.972 1.357-1.32.794-.428.562-1.357.463-1.852-.044-.22.372-.644.595-.63.925.068.53-.692.53-1.057a.52.52 0 0 1 .03-.182c.143-.425.764-.562.764-1.076 0-.36-.3-.527-.3-.89 0-.54.798-1.022 1.63-1.418A.665.665 0 0 0 18.026 3H21zM25 7h-2V6h3v20H6v-3h1v2h18zm5 3v20H10v-3h1v2h18V11h-2v-1z"
        />
        <path fill="none" d="M0 0h32v32H0z" />
      </svg>
      LEGEND
    </button>

    <button
      class="tablinks"
      (click)="currentLegend = 'Analisis'"
      [ngClass]="currentLegend == 'Analisis' ? 'active' : 'inactive'"
      style="position: relative; width: 50%"
    >
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="25"
        height="25"
        viewBox="0 0 32 32"
      >
        <path
          d="M3 29h27v1H2V2h1zM16 3h3v2.465l1 1V2h-5v4.122l1-.631zm3 23h-3V11.404l-1 .632V27h5V13.535l-1-1zM6 16h5v11H6zm1 10h3v-9H7zm21 0h-3v-7.464l-1-1V27h5v-7h-1zM25 9h3v5.464l.536.536H29V8h-5v2.465l1 1zm2.707 8L17.571 6.864 7.855 13H6v1h2.145l9.284-5.864L27.293 18H29v-1z"
        />
        <path fill="none" d="M0 0h32v32H0z" />
      </svg>
      ANALYISIS
    </button>
  </div>

  <div id="Legenda" [ngClass]="currentTab == 0 ? 'tabcontent-inactive' : 'tabcontent tab'" *ngIf="currentLegend == 'Legenda'">
    <div class="legend-container">
      <div [ngClass]="accordionState ? 'legend-top-1' : 'legend-top-2'">
        <ul id="layerList" class="list-group">
          <ng-container *ngIf="visibleLayersCount > 0; else noLayersTemplate">
            <div
              cdkDropList
              id="aboveBuilding"
              [cdkDropListData]="aboveBuilding"
              [cdkDropListConnectedTo]="['underBuilding']"
              (cdkDropListDropped)="drop($event)"
            >
              <ng-container *ngFor="let layer of splitLayers().above">
                <ng-container *ngIf="layer.visible">
                  <app-legend-list
                    class="example-box"
                    [layer]="layer"
                    cdkDrag
                    [attr.data-id]="layer.id"
                  >
                  </app-legend-list>
                </ng-container>
              </ng-container>
              <!-- Placeholder for empty list -->
              <div
                *ngIf="aboveBuilding.length === 0"
                class="empty-list-placeholder"
              >
                Drag and drop items here
              </div>
            </div>
          </ng-container>
        </ul>
      </div>
      
      <!-- Move the template outside of the list -->
      <ng-template #noLayersTemplate>
        <div class="no-data">
          <!-- ...existing empty state SVG and content... -->
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" width="80px" display="block">
            <path
            d="M14.419 12.212a6.042 6.042 0 0 0 1.177 2.135l-.604.525a6.829 6.829 0 0 1-1.333-2.41zm2.217 3.074l-.47.647a16.155 16.155 0 0 0 1.757 1.065l.536.297.393-.697-.544-.301a15.682 15.682 0 0 1-1.672-1.01zm3.522 2.15l-.484.636a5.214 5.214 0 0 1 1.558 1.841l.713-.361a5.966 5.966 0 0 0-1.787-2.116zm7.201 6.948l-.637-.052a41.033 41.033 0 0 0-3.26-.132 24.327 24.327 0 0 0-8.383 1.446A25.331 25.331 0 0 1 12 26.49v-1.018a25.48 25.48 0 0 0 2.769-.778c.997-.323 2.065-.662 3.314-.937-.232-1.45-1.788-3.042-3.7-3.69-.706-.239-1.116-.962-1.59-1.797-.896-1.584-2.02-3.531-5.574-3.311L6.382 20H5.37L7.42 7.644l.481.063a18.376 18.376 0 0 0 2.44.161 19.374 19.374 0 0 0 5.995-.924 14.818 14.818 0 0 1 4.74-.733 23.168 23.168 0 0 1 2.94.196l.369.048zM23.463 23.2c.204 0 .412.017.617.02-.384-5.412-2.643-6.531-4.834-7.602-2.18-1.065-4.422-2.176-4.155-7.302a19.29 19.29 0 0 1-1.204.256v.036a15.547 15.547 0 0 0 .197 2.211l-.79.133a16.254 16.254 0 0 1-.201-2.258 20.773 20.773 0 0 1-2.753.174 19.583 19.583 0 0 1-2.091-.111l-.862 5.192c4.01-.16 5.366 2.222 6.276 3.828.373.659.695 1.227 1.041 1.344a6.475 6.475 0 0 1 4.36 4.444 23.784 23.784 0 0 1 2.942-.33 10.971 10.971 0 0 0-.287-2.005l.773-.202a11.557 11.557 0 0 1 .313 2.188c.22-.005.427-.016.658-.016zm2.701.09L23.52 7.353a21.659 21.659 0 0 0-2.446-.143 13.94 13.94 0 0 0-4.452.691l-.514.147c-.344 4.74 1.39 5.602 3.578 6.67 2.348 1.149 4.996 2.46 5.398 8.535.36.014.72.012 1.08.035zM31 28a33.153 33.153 0 0 0-7.538-.8c-6.876 0-8.048 2.6-14.924 2.6A16.273 16.273 0 0 1 1 28L5 3.9a14.99 14.99 0 0 0 5.34.968c4.807 0 5.59-1.657 10.734-1.657A26.402 26.402 0 0 1 27 3.9zm-7.538-1.8a37.286 37.286 0 0 1 6.313.528l-3.651-22a26.164 26.164 0 0 0-5.05-.517 16.628 16.628 0 0 0-5.29.81 17.42 17.42 0 0 1-5.445.847 15.6 15.6 0 0 1-4.544-.65L2.107 27.433a15.989 15.989 0 0 0 6.43 1.366 20.422 20.422 0 0 0 7.156-1.252 22.381 22.381 0 0 1 7.77-1.348zM10 23h4v-.999h-4v-4H9v4H5V23h4v4.001h1z"
            fill="#757575"
          />
          </svg>
          <br /><br />
          <span>Use Data Catalog to Add Layers</span>
        </div>
      </ng-template>

      <div class="legend-bottom">
        <div class="tab-acc">
          <input
            type="checkbox"
            id="map-style-header"
            name="map_style_header"
            style="display: none"
          />
          <div class="row" class="tab-acc-label" (click)="clickAccordion()">
            <div class="col-11">
              <span for="map-style">BASEMAPS</span>
            </div>
            <div class="col-1">
              <i *ngIf="!accordionState" class="las la-angle-down"></i>
              <i *ngIf="accordionState" class="las la-angle-up"></i>
            </div>
          </div>
          <div class="tab-acc-content" *ngIf="accordionState">
            <div
              class="row map-style pointer"
              (click)="clickRupabumi()"
              [ngClass]="currentMapStyle == 'Rupabumi' ? 'map-style-active' : ''"
            >
              <span for="map-style-rupabumi">Map</span>
            </div>
            <div
              class="row map-style pointer"
              (click)="clickCitra()"
              [ngClass]="
                currentMapStyle == 'Citra Satelit' ? 'map-style-active' : ''
              "
            >
              <span for="map-style-citra">Satellite</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div
    id="Analisis"
    [ngClass]="currentTab == 0 ? 'tabcontent-inactive' : 'tabcontent'"
    *ngIf="currentLegend == 'Analisis'"
  >
    <ng-container *ngIf="config.analysis">
      <ng-container *ngIf="config.analysis.length > 0; else emptyArray">
        <ng-container *ngFor="let analysis of config.analysis">
          <ng-container [ngSwitch]="analysis.output.type">
            <ng-container *ngSwitchCase="'pajak'">
              <app-analisis-pajak [analisis]="analysis"></app-analisis-pajak>
            </ng-container>
            <ng-container *ngSwitchCase="'tataruang'">
              <app-analisis-tataruang
                [analisis]="analysis"
              ></app-analisis-tataruang>
            </ng-container>
            <ng-container *ngSwitchCase="'perizinan'">
              <app-analisis-perizinan
                [analisis]="analysis"
              ></app-analisis-perizinan>
            </ng-container>
          </ng-container>
        </ng-container>
      </ng-container>
    </ng-container>
    <ng-template #emptyArray
      ><div class="no-data">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 32 32"
          width="80px"
          display="block"
        >
          <path
            d="M4.278 15.742L8.5 19.964l4.222-4.222a2 2 0 0 1 1.414-.586 1.997 1.997 0 0 1 1.415.587l.707.708a1.999 1.999 0 0 1-.001 2.827L12.035 23.5l4.222 4.222a1.994 1.994 0 0 1 .227.278h4.641c-1.812-4.102-1.217-6.705-2.028-9.7-1.825-6.736-4.83-4.49-5.82-11.308A27.182 27.182 0 0 1 13 3H4v12.514a1.997 1.997 0 0 1 .278.228z"
            opacity=".25"
          />
          <path
            d="M19.731 22.661c.106.828.192 1.465.328 2.106l-.979.207c-.143-.678-.231-1.333-.34-2.186zm-1.6-4.099a12.05 12.05 0 0 1 .368 2.054l.996-.097a12.987 12.987 0 0 0-.398-2.218zm-1.686-3.766a7.908 7.908 0 0 1 1.001 1.77l.924-.38a8.835 8.835 0 0 0-1.128-1.994zm-1.42-1.559l.72-.695a8.005 8.005 0 0 1-1.26-1.606l-.866.502a9.102 9.102 0 0 0 1.406 1.8zm-2.28-3.912l.96-.275a15.776 15.776 0 0 1-.429-2.058l-.99.145a16.771 16.771 0 0 0 .458 2.188zM5 7H4v2h1zm0-3h1V3H4v2h1zm5-1H8v1h2zm6.484 25H17v-1h-1.465l.722.722a1.994 1.994 0 0 1 .227.278zM5 11H4v2h1zm0 5.464V15H4v.514a1.997 1.997 0 0 1 .278.228zm9.997-12.677c.003.074.008.14.012.213H28v5.97a14.314 14.314 0 0 0-8.996 3.411 8.01 8.01 0 0 1 .454.932A13.213 13.213 0 0 1 28 10.97V27h-5v1h6V3H14.999c-.002.262-.014.522-.002.787zm-2.94 1.147l.998-.067c-.021-.31-.045-.622-.055-.972S13 3 13 3h-1s-.011.635 0 1 .037.636.057.934zM19 28h2v-1h-2zM8.5 24.207l5.636 5.636.707-.707L9.207 23.5l5.636-5.636-.707-.707L8.5 22.793l-5.636-5.636-.707.707L7.793 23.5l-5.636 5.636.707.707z"
            fill="#757575"
          />
          <path fill="none" d="M0 0h32v32H0z" />
        </svg>
        <br /><br />
        <span>No Active Analysis</span>
        <br /><br />
        <span>Select or Draw Area to Start Analyse</span>
      </div></ng-template
    >
  </div>
</div>
